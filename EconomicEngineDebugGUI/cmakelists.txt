cmake_minimum_required(VERSION 3.2)

project(EconomicEngineDebugGUI VERSION 1.0.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)

set(CMAKE_INCLUDE_CURRENT_DIR ON)

set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_AUTOUIC ON)

if(WIN32)
    set(QT_VERSION "5.15.2")
    set(CMAKE_PREFIX_PATH J:/QT/${QT_VERSION}/msvc2019_64)
endif(WIN32)

find_package(Qt5 ${QT_VERSION} COMPONENTS
    Core 
    Widgets 
    Gui
    PrintSupport
    REQUIRED
)

set(HEADER_DIR ${CMAKE_CURRENT_SOURCE_DIR}/includes)
set(SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/src)

set(HEADERS
    ${HEADER_DIR}/JobManager.h
    ${HEADER_DIR}/GraphManager.h
    ${HEADER_DIR}/DebugEconomicEngine.h
    ${HEADER_DIR}/EconomicEngineDebugGUI.ui
    ${HEADER_DIR}/EconomicEngineDebugGUI.h
    ${HEADER_DIR}/qcustomplot.h
)

set(SOURCES
	${SOURCE_DIR}/main.cpp
    ${SOURCE_DIR}/JobManager.cpp
    ${SOURCE_DIR}/GraphManager.cpp
    ${SOURCE_DIR}/DebugEconomicEngine.cpp
    ${SOURCE_DIR}/EconomicEngineDebugGUI.cpp
    ${SOURCE_DIR}/EconomicEngineDebugGUI.qrc
    ${SOURCE_DIR}/qcustomplot.cpp
)

add_executable(${PROJECT_NAME} ${SOURCES} ${HEADERS})
target_include_directories(${PROJECT_NAME}
	PUBLIC
		${HEADER_DIR}
)
include_directories(${EconomicEngine_SOURCE_DIR})
target_link_libraries(${PROJECT_NAME}
    PUBLIC
        ${Qt5Widgets_LIBRARIES}
        Qt5::Core
        Qt5::Widgets
        Qt5::Gui
        Qt5::PrintSupport
		EconomicEngine
)

target_compile_features(${PROJECT_NAME}
    PRIVATE 
        cxx_auto_type
)
target_compile_definitions(${PROJECT_NAME}
    PUBLIC
        ${Qt5Widgets_DEFINITIONS}
)

if(WIN32)
    add_custom_command(
        TARGET ${PROJECT_NAME} POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
            $<TARGET_FILE:Qt5::Widgets>
            $<TARGET_FILE:Qt5::Core>
            $<TARGET_FILE:Qt5::Gui>
            $<TARGET_FILE:Qt5::PrintSupport>
            $<TARGET_FILE_DIR:${PROJECT_NAME}>
    )
endif(WIN32)

file(COPY ${CMAKE_SOURCE_DIR}/Content DESTINATION ${CMAKE_CURRENT_BINARY_DIR})
